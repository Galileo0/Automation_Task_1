const a87_0x486d9d=a87_0x8e22;(function(_0x4209ce,_0x55be57){const _0xbd1cf4=a87_0x8e22,_0x6d4d4a=_0x4209ce();while(!![]){try{const _0x414a29=parseInt(_0xbd1cf4(0xfc))/0x1+-parseInt(_0xbd1cf4(0xa7))/0x2*(parseInt(_0xbd1cf4(0xff))/0x3)+-parseInt(_0xbd1cf4(0xf9))/0x4*(parseInt(_0xbd1cf4(0xcc))/0x5)+-parseInt(_0xbd1cf4(0x107))/0x6+-parseInt(_0xbd1cf4(0xab))/0x7+-parseInt(_0xbd1cf4(0xd5))/0x8+parseInt(_0xbd1cf4(0x10c))/0x9*(parseInt(_0xbd1cf4(0xdb))/0xa);if(_0x414a29===_0x55be57)break;else _0x6d4d4a['push'](_0x6d4d4a['shift']());}catch(_0x51852b){_0x6d4d4a['push'](_0x6d4d4a['shift']());}}}(a87_0x96a5,0x939c4));function a87_0x8e22(_0x19ac1b,_0x32ffaa){const _0x96a5c1=a87_0x96a5();return a87_0x8e22=function(_0x8e22be,_0x2ced8f){_0x8e22be=_0x8e22be-0x9f;let _0x2712d1=_0x96a5c1[_0x8e22be];return _0x2712d1;},a87_0x8e22(_0x19ac1b,_0x32ffaa);}const bsSetupHelper=require(a87_0x486d9d(0xcf)),path=require(a87_0x486d9d(0xaf)),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require(a87_0x486d9d(0x104)),testhubUtils=require(a87_0x486d9d(0xc4)),testHubConstants=require(a87_0x486d9d(0xc2)),constants=require(a87_0x486d9d(0x105)),RequestQueueHandler=require('../test-observability/requestQueueHandler.js'),logger=require(a87_0x486d9d(0xf2))[a87_0x486d9d(0xd9)],SessionHandler=require('../test-observability/sessionHandler.js');class TestHubHandler{static [a87_0x486d9d(0xe4)]=![];static async[a87_0x486d9d(0xde)](_0x31123c,_0x44fc6f){const _0x2eccca=a87_0x486d9d,_0x5bfa8d={'SMQIL':function(_0x50d1ce,_0x158840){return _0x50d1ce||_0x158840;},'LADea':function(_0x1cd467,_0x4eecf1){return _0x1cd467||_0x4eecf1;},'vqcml':function(_0x4df7a9,_0x10c53e){return _0x4df7a9===_0x10c53e;},'wkizA':function(_0x150512){return _0x150512();},'HpSmt':'EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','jVRfF':_0x2eccca(0x9f),'MIxCp':_0x2eccca(0x10b),'pwzuc':function(_0x3fad1d,_0x4917a4,_0x23e628,_0x43c127,_0x1d8822){return _0x3fad1d(_0x4917a4,_0x23e628,_0x43c127,_0x1d8822);},'mDJRy':_0x2eccca(0xba)},_0x428a5f={};_0x428a5f[_0x2eccca(0xec)]='';const _0x436a7e=Object[_0x2eccca(0x10a)]({},_0x44fc6f[_0x2eccca(0x108)],_0x428a5f),_0x34222a=bsSetupHelper[_0x2eccca(0xb9)](_0x436a7e),_0x5d54ca=bsSetupHelper[_0x2eccca(0xe3)](_0x436a7e),_0x3230f0=_0x5bfa8d[_0x2eccca(0xda)](_0x34222a,'')+':'+_0x5bfa8d[_0x2eccca(0xf1)](_0x5d54ca,''),_0x70c442=testhubUtils[_0x2eccca(0xd7)](_0x436a7e);process[_0x2eccca(0xf0)][_0x2eccca(0xbd)]=JSON[_0x2eccca(0xb3)](_0x70c442);if(_0x5bfa8d[_0x2eccca(0xb0)](_0x3230f0,':'))return _0x5bfa8d[_0x2eccca(0xd4)](isTestObservabilitySession)&&(logger[_0x2eccca(0x113)](_0x5bfa8d[_0x2eccca(0xb2)]),process[_0x2eccca(0xf0)][_0x2eccca(0xd3)]=_0x5bfa8d['jVRfF']),testhubUtils[_0x2eccca(0x102)](_0x436a7e)&&logger[_0x2eccca(0x113)](_0x5bfa8d['MIxCp']),[null,null];try{const _0x5e3026=await this[_0x2eccca(0xe6)](_0x436a7e,_0x31123c),_0x43b35a=this[_0x2eccca(0xe9)](_0x34222a,_0x5d54ca),_0x173d90=await _0x5bfa8d[_0x2eccca(0xaa)](nodeRequest,_0x5bfa8d[_0x2eccca(0xa5)],testHubConstants['TESTHUB_BUILD_API'],_0x5e3026,_0x43b35a);await this['checkAndSetupPercy'](_0x44fc6f,_0x31123c);const _0x12b3c2=this[_0x2eccca(0xdf)](_0x436a7e,_0x173d90,_0x43b35a);return _0x12b3c2;}catch(_0x55ee36){if(_0x5bfa8d['vqcml'](_0x55ee36[_0x2eccca(0xd1)],![])){testhubUtils[_0x2eccca(0xd2)](_0x55ee36);return;}}}static async[a87_0x486d9d(0xbc)](_0x320876,_0x4a71bb){const _0x335d73=a87_0x486d9d;if(constants['PERCY_SUPPORTED_FRAMEWORKS']['includes'](_0x4a71bb)){await _0x320876['setupPercy']();return;}_0x320876[_0x335d73(0x108)]['percy']&&logger[_0x335d73(0x113)](_0x335d73(0x10e)+_0x4a71bb+_0x335d73(0xeb));}static[a87_0x486d9d(0xbb)](_0x46895f){const _0x2c57ed=a87_0x486d9d,_0x54e117={};_0x54e117[_0x2c57ed(0xb7)]=_0x46895f[_0x2c57ed(0xe1)];const _0x172410=_0x54e117;return _0x172410;}static['getConfig'](_0x4dc44c,_0x1552b4){const _0x4f82e5=a87_0x486d9d,_0x434ad3={'fIvHW':function(_0x5b08f5,_0x57ae25){return _0x5b08f5(_0x57ae25);}},_0x4e7bf8={};return _0x4e7bf8[_0x4f82e5(0xa4)]=_0x4dc44c,_0x4e7bf8[_0x4f82e5(0xc8)]=_0x1552b4,{'auth':_0x4e7bf8,'headers':_0x434ad3[_0x4f82e5(0xce)](getDefaultHeaders,![])};}static async[a87_0x486d9d(0xe6)](_0x5de5c2,_0x248cca){const _0x566aad=a87_0x486d9d,_0x244673={'wvvWM':function(_0x24071c,_0x2423fd){return _0x24071c(_0x2423fd);}},_0x172bb5={'project_name':_0x5de5c2['projectName']||'','name':_0x5de5c2['buildName']||path['basename'](path[_0x566aad(0xcb)](process[_0x566aad(0x112)]())),'build_identifier':_0x5de5c2['buildIdentifier'],'description':_0x5de5c2[_0x566aad(0xf8)]||'','started_at':new Date()[_0x566aad(0xc7)](),'tags':_0x244673[_0x566aad(0xef)](getCustomTags,_0x5de5c2),'host_info':bsSetupHelper[_0x566aad(0xb5)](),'ci_info':bsSetupHelper[_0x566aad(0xcd)](),'build_run_identifier':process['env'][_0x566aad(0xf5)],'failed_tests_rerun':process[_0x566aad(0xf0)]['BROWSERSTACK_RERUN']||![],'version_control':await bsSetupHelper[_0x566aad(0xae)](),'accessibility':this[_0x566aad(0xbb)](_0x5de5c2),'framework_details':testhubUtils[_0x566aad(0xc9)](_0x5de5c2,_0x248cca),'product_map':testhubUtils['getProductMap'](_0x5de5c2),'browserstackAutomation':bsSetupHelper[_0x566aad(0x111)]()};if(process[_0x566aad(0xf0)][_0x566aad(0xe5)]){const _0x227a9b={};_0x227a9b['job_id']=process[_0x566aad(0xf0)][_0x566aad(0xc0)],_0x227a9b[_0x566aad(0x100)]=process[_0x566aad(0xf0)][_0x566aad(0xbf)],_0x172bb5[_0x566aad(0xa0)]=_0x227a9b;}return _0x172bb5;}static[a87_0x486d9d(0xdf)](_0x33aa18,_0x553fb5,_0x1329b0){const _0x440bff=a87_0x486d9d,_0x4d8190={'sFFwi':function(_0x435b6c){return _0x435b6c();},'NRhal':function(_0x115b2f,_0x281a27){return _0x115b2f&&_0x281a27;},'MZRSJ':_0x440bff(0xfd),'dJeaB':_0x440bff(0x9f)},_0x570d16={};if(_0x4d8190[_0x440bff(0xea)](isTestObservabilitySession)){const [_0x49fb73,_0x94099e,_0x3effc8]=testhubUtils[_0x440bff(0xf3)](_0x553fb5[_0x440bff(0x114)],_0x1329b0[_0x440bff(0xd6)]);if(_0x4d8190['NRhal'](_0x49fb73,_0x94099e)){const _0x4fd372={};_0x4fd372[_0x440bff(0xc3)]=_0x49fb73,_0x4fd372[_0x440bff(0xc6)]=_0x94099e,_0x4fd372[_0x440bff(0xf4)]=_0x3effc8,_0x570d16[testHubConstants[_0x440bff(0xf6)]]=_0x4fd372,process[_0x440bff(0xf0)]['BROWSERSTACK_TEST_OBSERVABILITY']=_0x4d8190['MZRSJ'];}else _0x570d16[testHubConstants['OBSERVABILITY']]={},process[_0x440bff(0xf0)][_0x440bff(0xdd)]=_0x4d8190[_0x440bff(0xd8)];}else process[_0x440bff(0xf0)][_0x440bff(0xdd)]=_0x4d8190[_0x440bff(0xd8)];if(testhubUtils[_0x440bff(0x102)](_0x33aa18)){const [_0x386db0,_0x40bfaa]=testhubUtils[_0x440bff(0xe0)](_0x553fb5['data']);if(_0x4d8190['NRhal'](_0x386db0,_0x40bfaa)){const _0x59da5f={};_0x59da5f[_0x440bff(0xb1)]=_0x386db0,_0x59da5f['buildHashedId']=_0x40bfaa,_0x570d16[testHubConstants[_0x440bff(0xfa)]]=_0x59da5f,process[_0x440bff(0xf0)][_0x440bff(0x110)]=_0x4d8190[_0x440bff(0xca)];}else _0x570d16[testHubConstants['ACCESSIBILITY']]={},process[_0x440bff(0xf0)][_0x440bff(0x110)]=_0x4d8190[_0x440bff(0xd8)];}else process[_0x440bff(0xf0)][_0x440bff(0x110)]=_0x4d8190[_0x440bff(0xd8)];return testhubUtils['setTestHubCommonMetaInfo'](_0x553fb5['data']),_0x570d16;}static async[a87_0x486d9d(0x10d)](_0x3deed7){const _0x23929e=a87_0x486d9d,_0x37426d={'nIPbS':function(_0x5a1fe9,_0x5abe08){return _0x5a1fe9===_0x5abe08;},'ePvWe':_0x23929e(0x9f),'VwFvB':_0x23929e(0x10f),'tmbcc':function(_0x267dab,_0x3408da){return _0x267dab===_0x3408da;},'gZZsA':'EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','Dawle':_0x23929e(0xc5),'zaISn':'Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','NsGfz':'finished_metadata','TdBlK':_0x23929e(0xf7),'hdsdw':function(_0x3d7aee){return _0x3d7aee();},'BFlPJ':function(_0x10e6ae,_0x561755,_0x5e3a91,_0x162845,_0x3b4d8d,_0x8e77ec){return _0x10e6ae(_0x561755,_0x5e3a91,_0x162845,_0x3b4d8d,_0x8e77ec);},'hPtOA':_0x23929e(0x101),'AxPwn':_0x23929e(0xbe),'qAAWJ':_0x23929e(0xd1)};if(_0x37426d[_0x23929e(0xb4)](process['env'][_0x23929e(0xd3)],_0x37426d[_0x23929e(0xa6)])||this[_0x23929e(0xe4)]||bsSetupHelper[_0x23929e(0xe2)](process['env'][testHubConstants[_0x23929e(0x109)][_0x23929e(0xac)]]))return;this['buildStopSent']=!![],await RequestQueueHandler['getInstance']()[_0x23929e(0xd0)](),await SessionHandler[_0x23929e(0xee)]();if(_0x37426d[_0x23929e(0xb4)](process['env'][testHubConstants[_0x23929e(0x109)][_0x23929e(0xac)]],_0x37426d[_0x23929e(0xfe)])||_0x37426d[_0x23929e(0x103)](process['env'][testHubConstants['ENV_VAR'][_0x23929e(0xa8)]],_0x37426d[_0x23929e(0xfe)])){logger[_0x23929e(0x113)](_0x37426d[_0x23929e(0xa9)]);const _0x3adb99={};return _0x3adb99[_0x23929e(0xed)]=_0x37426d[_0x23929e(0xc1)],_0x3adb99['message']=_0x37426d['zaISn'],_0x3adb99;}const _0xa86afe={'finished_at':new Date()[_0x23929e(0xc7)](),'finished_metadata':[]};!!_0x3deed7&&_0xa86afe[_0x37426d[_0x23929e(0xe8)]]['push']({'reason':_0x37426d[_0x23929e(0xa3)],'signal':_0x3deed7,'failure_data':''});const _0x4d6a8a={'headers':_0x37426d['hdsdw'](getDefaultHeaders)};try{const _0x47b55f=await _0x37426d['BFlPJ'](nodeRequest,_0x37426d['hPtOA'],_0x23929e(0xa2)+process['env'][testHubConstants[_0x23929e(0x109)][_0x23929e(0xa8)]]+_0x23929e(0xb8),_0xa86afe,_0x4d6a8a,![]);if(_0x47b55f[_0x23929e(0x114)]&&_0x47b55f[_0x23929e(0x114)][_0x23929e(0xc5)]){const _0x527570={};_0x527570[_0x23929e(0xfb)]=_0x47b55f[_0x23929e(0x114)][_0x23929e(0xc5)];throw _0x527570;}else{logger[_0x23929e(0x113)](_0x37426d[_0x23929e(0xb6)]);const _0x136132={};return _0x136132[_0x23929e(0xed)]=_0x37426d[_0x23929e(0xa1)],_0x136132[_0x23929e(0xfb)]='',_0x136132;}}catch(_0x2cd297){_0x2cd297[_0x23929e(0xe7)]?logger[_0x23929e(0x113)](_0x23929e(0x106)+_0x2cd297[_0x23929e(0xe7)]['status']+'\x20'+_0x2cd297[_0x23929e(0xe7)]['statusText']+'\x20'+JSON[_0x23929e(0xb3)](_0x2cd297[_0x23929e(0xe7)][_0x23929e(0x114)])):logger[_0x23929e(0x113)](_0x23929e(0x106)+(_0x2cd297[_0x23929e(0xfb)]||_0x2cd297));const _0x4c6ebe={};return _0x4c6ebe[_0x23929e(0xed)]=_0x37426d[_0x23929e(0xc1)],_0x4c6ebe[_0x23929e(0xfb)]=_0x2cd297[_0x23929e(0xfb)]||_0x2cd297[_0x23929e(0xe7)]?_0x2cd297[_0x23929e(0xe7)][_0x23929e(0xed)]+':'+_0x2cd297[_0x23929e(0xe7)][_0x23929e(0xdc)]:_0x2cd297,_0x4c6ebe;}}}function a87_0x96a5(){const _0x1a9cf7=['qAAWJ','api/v1/builds/','TdBlK','username','mDJRy','ePvWe','10WbIrYh','BROWSERSTACK_TESTHUB_UUID','gZZsA','pwzuc','5270111ijPXUY','BROWSERSTACK_TESTHUB_JWT','exports','getGitMetaData','path','vqcml','authToken','HpSmt','stringify','nIPbS','getHostInfo','AxPwn','settings','/stop','getUserName','POST','getAccessibilityOptions','checkAndSetupPercy','BROWSERSTACK_PRODUCT_MAP','stopBuildUpstream\x20event\x20successful!','BROWSERSTACK_CENTRAL_SCANNER_JWT','BROWSERSTACK_CENTRAL_SCANNER_JOBID','Dawle','./constants.js','jwt','./utils.js','error','buildHashedId','toISOString','password','getFrameworkDetails','MZRSJ','resolve','455mhNSmc','getCiInfo','fIvHW','../helper','uploadPending','success','logBuildError','BS_TESTOPS_BUILD_COMPLETED','wkizA','7134672zJtGgg','auth','getProductMap','dJeaB','winstonLogger','SMQIL','13210DVNWsS','statusText','BROWSERSTACK_TEST_OBSERVABILITY','launchBuild','extractDataFromResponse','setAccessibilityVariables','accessibilityOptions','isUndefined','getAccessKey','buildStopSent','BROWSERSTACK_CENTRAL_USER','generateBuildUpstreamData','response','NsGfz','getConfig','sFFwi','\x20framework','root_dir_path','status','waitForBuildStatus','wvvWM','env','LADea','../logger','setTestObservabilityVariables','allowScreenshot','BROWSERSTACK_BUILD_RUN_IDENTIFIER','OBSERVABILITY','user_killed','buildDescription','25644enmwhG','ACCESSIBILITY','message','511454PqJxKj','true','VwFvB','584763LzfMLv','token','PUT','isAccessibilityEnabled','tmbcc','../test-observability/utils','../../bin/utils/constants.js','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','3075432xeMXbq','config','ENV_VAR','assign','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','25947SnszOE','stop','Percy\x20is\x20not\x20supported\x20for\x20','null','BROWSERSTACK_ACCESSIBILITY','isBrowserstackInfra','cwd','debug','data','false','central_scanner'];a87_0x96a5=function(){return _0x1a9cf7;};return a87_0x96a5();}module[a87_0x486d9d(0xad)]=TestHubHandler;