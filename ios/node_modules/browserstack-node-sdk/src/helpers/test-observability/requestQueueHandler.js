const a83_0x545d48=a83_0x2af8;(function(_0x421878,_0x40e65f){const _0x1713ed=a83_0x2af8,_0x10ec42=_0x421878();while(!![]){try{const _0x453ecb=-parseInt(_0x1713ed(0x139))/0x1*(parseInt(_0x1713ed(0x166))/0x2)+parseInt(_0x1713ed(0x131))/0x3*(parseInt(_0x1713ed(0x13d))/0x4)+-parseInt(_0x1713ed(0x143))/0x5+-parseInt(_0x1713ed(0x158))/0x6+-parseInt(_0x1713ed(0x14a))/0x7*(-parseInt(_0x1713ed(0x150))/0x8)+parseInt(_0x1713ed(0x130))/0x9*(parseInt(_0x1713ed(0x134))/0xa)+-parseInt(_0x1713ed(0x168))/0xb*(-parseInt(_0x1713ed(0x12e))/0xc);if(_0x453ecb===_0x40e65f)break;else _0x10ec42['push'](_0x10ec42['shift']());}catch(_0xe58e88){_0x10ec42['push'](_0x10ec42['shift']());}}}(a83_0x1f11,0x7d04d));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require('./constants'),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a83_0x545d48(0x141)),{nestedKeyValue}=require('../helper'),util=require(a83_0x545d48(0x11e));function a83_0x2af8(_0x412954,_0x2a92c9){const _0x1f1154=a83_0x1f11();return a83_0x2af8=function(_0x2af8a0,_0x47d9e6){_0x2af8a0=_0x2af8a0-0x112;let _0x4a98ed=_0x1f1154[_0x2af8a0];return _0x4a98ed;},a83_0x2af8(_0x412954,_0x2a92c9);}class RequestQueueHandler{static ['instance'];[a83_0x545d48(0x16e)]=0x0;constructor(){const _0x3f7c82=a83_0x545d48,_0x4b4e14={};_0x4b4e14[_0x3f7c82(0x153)]=_0x3f7c82(0x136),_0x4b4e14[_0x3f7c82(0x15f)]='LogCreated',_0x4b4e14[_0x3f7c82(0x152)]=_0x3f7c82(0x175),_0x4b4e14[_0x3f7c82(0x11a)]=_0x3f7c82(0x146),_0x4b4e14[_0x3f7c82(0x11f)]=_0x3f7c82(0x162),_0x4b4e14[_0x3f7c82(0x14f)]=_0x3f7c82(0x173),_0x4b4e14[_0x3f7c82(0x15b)]=_0x3f7c82(0x118),_0x4b4e14['dDOKy']=_0x3f7c82(0x140),_0x4b4e14[_0x3f7c82(0x137)]=_0x3f7c82(0x117),_0x4b4e14[_0x3f7c82(0x161)]=_0x3f7c82(0x12d);const _0x4d34fa=_0x4b4e14,_0x16ab72=_0x4d34fa[_0x3f7c82(0x153)][_0x3f7c82(0x155)]('|');let _0x9437e7=0x0;while(!![]){switch(_0x16ab72[_0x9437e7++]){case'0':this[_0x3f7c82(0x17c)]=[_0x4d34fa['Lekjw'],_0x4d34fa['rtgtC'],_0x4d34fa[_0x3f7c82(0x11a)],_0x4d34fa[_0x3f7c82(0x11f)],_0x4d34fa[_0x3f7c82(0x14f)],_0x4d34fa['hhasg'],_0x4d34fa['dDOKy']];continue;case'1':this[_0x3f7c82(0x13c)]=null;continue;case'2':this['screenshotEventUrl']=_0x4d34fa[_0x3f7c82(0x137)];continue;case'3':this['eventUrl']=_0x4d34fa[_0x3f7c82(0x161)];continue;case'4':this[_0x3f7c82(0x124)]=![];continue;case'5':this['queue']=[];continue;}break;}}static[a83_0x545d48(0x16b)](){const _0x1b3f07=a83_0x545d48;return!RequestQueueHandler['instance']&&(RequestQueueHandler[_0x1b3f07(0x14e)]=new RequestQueueHandler()),RequestQueueHandler['instance'];}['start']=()=>{const _0x15ca2c=a83_0x545d48;!this[_0x15ca2c(0x124)]&&(this[_0x15ca2c(0x124)]=!![],this[_0x15ca2c(0x13f)]());};[a83_0x545d48(0x163)]=_0x57a074=>{const _0x2e8604=a83_0x545d48,_0x523914={'ARIZM':function(_0x267a02,_0x5cfd12){return _0x267a02===_0x5cfd12;},'nZWMD':_0x2e8604(0x128),'vuTVe':function(_0x4db157,_0x430ffb){return _0x4db157(_0x430ffb);},'BlPKc':'Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..'};if(this[_0x2e8604(0x17c)][_0x2e8604(0x174)](_0x57a074[_0x2e8604(0x12c)])){if(_0x57a074['logs']&&_0x57a074[_0x2e8604(0x121)][0x0]&&_0x523914[_0x2e8604(0x135)](_0x57a074[_0x2e8604(0x121)][0x0][_0x2e8604(0x145)],_0x523914[_0x2e8604(0x122)])){const _0x2f4a88={};return _0x2f4a88['shouldProceed']=!![],_0x2f4a88['proceedWithData']=[_0x57a074],_0x2f4a88[_0x2e8604(0x156)]=this[_0x2e8604(0x178)],_0x2f4a88;}this[_0x2e8604(0x123)][_0x2e8604(0x16a)](_0x57a074);let _0x129534=null;const _0x2f06ca=this[_0x2e8604(0x127)]();_0x2f06ca&&(_0x523914[_0x2e8604(0x142)](trace,_0x523914[_0x2e8604(0x14b)]),_0x129534=this[_0x2e8604(0x123)]['slice'](0x0,BATCH_SIZE),this[_0x2e8604(0x123)][_0x2e8604(0x17b)](0x0,BATCH_SIZE),this[_0x2e8604(0x126)]());const _0x5dc321={};return _0x5dc321[_0x2e8604(0x127)]=_0x2f06ca,_0x5dc321[_0x2e8604(0x11c)]=_0x129534,_0x5dc321[_0x2e8604(0x156)]=this[_0x2e8604(0x167)],_0x5dc321;}const _0x44052f={};return _0x44052f[_0x2e8604(0x127)]=!![],_0x44052f;};[a83_0x545d48(0x116)]=async()=>{const _0x40bce2=a83_0x545d48,_0x186b12={'BnvgT':'REMOVING','xmBMw':function(_0x2c785b,_0x10b2d6){return _0x2c785b>_0x10b2d6;},'BucTL':_0x40bce2(0x16f),'QnDXv':function(_0x1218b9,_0xcc42a0){return _0x1218b9>_0xcc42a0;},'RRbao':function(_0x14583a,_0x1271d8){return _0x14583a(_0x1271d8);}};await this['uploadPending'](),this[_0x40bce2(0x115)](_0x186b12[_0x40bce2(0x165)]);while(_0x186b12['xmBMw'](this[_0x40bce2(0x123)][_0x40bce2(0x171)],0x0)){const _0x52b873=this[_0x40bce2(0x123)][_0x40bce2(0x13a)](0x0,BATCH_SIZE);this[_0x40bce2(0x123)][_0x40bce2(0x17b)](0x0,BATCH_SIZE),await this[_0x40bce2(0x12a)](this[_0x40bce2(0x167)],_0x186b12['BucTL'],_0x52b873);}_0x186b12[_0x40bce2(0x15a)](this['pendingUploads'],0x0)&&_0x186b12['RRbao'](debug,_0x40bce2(0x12b)+this[_0x40bce2(0x16e)]);};[a83_0x545d48(0x12a)]=async(_0x5d64e1,_0xe8caed,_0x1ef1d2)=>{const _0x2adcd9=a83_0x545d48,_0x1aba1f={'GOtLN':function(_0x5d03c0,_0x23e606){return _0x5d03c0(_0x23e606);},'NmBGy':_0x2adcd9(0x179),'gBrpV':function(_0x4ca866,_0x4ad7cf){return _0x4ca866(_0x4ad7cf);},'RuZNF':function(_0x267a4d){return _0x267a4d();},'BhSuZ':function(_0x3065d9,_0x3ed632,_0x1e6b6a,_0x50bd0a,_0x48dc5a){return _0x3065d9(_0x3ed632,_0x1e6b6a,_0x50bd0a,_0x48dc5a);},'Zdihh':_0x2adcd9(0x160),'aZbgW':function(_0x212cca,_0x50d5e6){return _0x212cca(_0x50d5e6);},'qRHEu':function(_0x5b1555,_0x588dce){return _0x5b1555-_0x588dce;},'LcZPF':function(_0x3d8912,_0x53f9ad){return _0x3d8912(_0x53f9ad);}};let _0x246eb3='';try{_0x246eb3=_0x1ef1d2[_0x2adcd9(0x114)](_0x13fca2=>'\x27'+_0x13fca2[_0x2adcd9(0x12c)]+'\x27:'+(nestedKeyValue(_0x13fca2,['test_run',_0x2adcd9(0x132)])||nestedKeyValue(_0x13fca2,['hook_run',_0x2adcd9(0x132)])))['join'](','),_0x1aba1f['GOtLN'](debug,'Processing\x20batch\x20events\x20for\x20'+_0xe8caed+_0x2adcd9(0x164)+Buffer[_0x2adcd9(0x119)](util[_0x2adcd9(0x129)]('%j',_0x1ef1d2),_0x1aba1f[_0x2adcd9(0x151)])+_0x2adcd9(0x12f)+_0x246eb3);}catch(_0x259a5d){_0x1aba1f['gBrpV'](debug,'Exception\x20in\x20logging\x20batch\x20events\x20--\x20'+util[_0x2adcd9(0x129)](_0x259a5d)+'}');}const _0x2e204e={'headers':_0x1aba1f[_0x2adcd9(0x144)](getDefaultHeaders)};try{const _0xdf68fc=await _0x1aba1f['BhSuZ'](nodeRequest,_0x1aba1f[_0x2adcd9(0x148)],_0x5d64e1,_0x1ef1d2,_0x2e204e);if(_0xdf68fc[_0x2adcd9(0x169)][_0x2adcd9(0x170)]){const _0x1eacb1={};_0x1eacb1[_0x2adcd9(0x113)]=_0xdf68fc['data'][_0x2adcd9(0x170)];throw _0x1eacb1;}else _0x1aba1f[_0x2adcd9(0x154)](debug,_0xe8caed+_0x2adcd9(0x112)+_0x246eb3+'\x20--\x20'+util[_0x2adcd9(0x129)]('%j',_0xdf68fc[_0x2adcd9(0x169)])),this[_0x2adcd9(0x16e)]=Math[_0x2adcd9(0x176)](0x0,_0x1aba1f[_0x2adcd9(0x16c)](this[_0x2adcd9(0x16e)],_0x1ef1d2[_0x2adcd9(0x171)]));}catch(_0x33086d){_0x33086d[_0x2adcd9(0x133)]?_0x1aba1f[_0x2adcd9(0x172)](debug,_0x2adcd9(0x125)+_0xe8caed+_0x2adcd9(0x13e)+_0x33086d[_0x2adcd9(0x133)][_0x2adcd9(0x177)]+'\x20'+_0x33086d[_0x2adcd9(0x133)]['statusText']+'\x20'+JSON[_0x2adcd9(0x159)](_0x33086d[_0x2adcd9(0x133)]['data'])):_0x1aba1f[_0x2adcd9(0x154)](debug,'EXCEPTION\x20IN\x20'+_0xe8caed+_0x2adcd9(0x13e)+(_0x33086d[_0x2adcd9(0x113)]||_0x33086d)),this['pendingUploads']=Math[_0x2adcd9(0x176)](0x0,_0x1aba1f['qRHEu'](this['pendingUploads'],_0x1ef1d2[_0x2adcd9(0x171)]));}};[a83_0x545d48(0x13f)]=()=>{const _0x40721e=a83_0x545d48,_0x5d9bb5={'oFZjX':function(_0x15df5f,_0x2b33b0){return _0x15df5f>_0x2b33b0;},'tRFej':function(_0x312c83,_0x18bbd9){return _0x312c83(_0x18bbd9);},'VnzBw':'Interval-Queue','cOpIO':function(_0x35c4a9,_0x5b999c,_0x373e3d){return _0x35c4a9(_0x5b999c,_0x373e3d);}};this[_0x40721e(0x13c)]=_0x5d9bb5['cOpIO'](setInterval,async()=>{const _0x26e848=_0x40721e;if(_0x5d9bb5[_0x26e848(0x13b)](this[_0x26e848(0x123)][_0x26e848(0x171)],0x0)){_0x5d9bb5[_0x26e848(0x14c)](trace,_0x26e848(0x120)+this[_0x26e848(0x123)][_0x26e848(0x171)]);const _0xfbf649=this[_0x26e848(0x123)]['slice'](0x0,BATCH_SIZE);this[_0x26e848(0x123)]['splice'](0x0,BATCH_SIZE),await this[_0x26e848(0x12a)](this[_0x26e848(0x167)],_0x5d9bb5[_0x26e848(0x15c)],_0xfbf649),_0x5d9bb5[_0x26e848(0x14c)](trace,_0x26e848(0x17a)+this['queue']['length']);}},BATCH_INTERVAL);};[a83_0x545d48(0x126)]=()=>{const _0x7a466=a83_0x545d48,_0xfa2015={};_0xfa2015[_0x7a466(0x157)]=_0x7a466(0x11b);const _0x58fc48=_0xfa2015;this[_0x7a466(0x115)](_0x58fc48[_0x7a466(0x157)]),this[_0x7a466(0x13f)]();};['removeEventBatchPolling']=_0x556386=>{const _0x191049=a83_0x545d48,_0x1ed538={'Kbrqk':function(_0xb50014,_0x40b976){return _0xb50014(_0x40b976);},'tEDzJ':function(_0x2dbf0f,_0x9cb44e){return _0x2dbf0f===_0x9cb44e;},'rYmdN':_0x191049(0x147)};this[_0x191049(0x13c)]&&(_0x1ed538[_0x191049(0x14d)](clearInterval,this[_0x191049(0x13c)]),this[_0x191049(0x13c)]=null,_0x1ed538['tEDzJ'](_0x556386,_0x1ed538[_0x191049(0x15e)])&&(this[_0x191049(0x124)]=![]));};[a83_0x545d48(0x127)]=()=>{const _0x2f0d44=a83_0x545d48,_0x2dd89f={};_0x2dd89f[_0x2f0d44(0x15d)]=function(_0x242068,_0x398f1b){return _0x242068>=_0x398f1b;};const _0x2f2b96=_0x2dd89f;return _0x2f2b96[_0x2f0d44(0x15d)](this[_0x2f0d44(0x123)][_0x2f0d44(0x171)],BATCH_SIZE);};async[a83_0x545d48(0x138)](_0x3839c7=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x5da63a=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x4edd86=a83_0x545d48,_0x450c73={'LueiB':function(_0x50bfae,_0x49cdb1){return _0x50bfae<=_0x49cdb1;},'hXjGZ':function(_0x19e64e,_0xa62a37){return _0x19e64e(_0xa62a37);},'aLcaD':function(_0x35d89c,_0x503bc1){return _0x35d89c-_0x503bc1;}};if(_0x450c73[_0x4edd86(0x149)](this[_0x4edd86(0x16e)],0x0)||_0x450c73[_0x4edd86(0x149)](_0x3839c7,0x0))return;return await _0x450c73['hXjGZ'](sleep,_0x5da63a),this[_0x4edd86(0x138)](_0x450c73[_0x4edd86(0x11d)](_0x3839c7,_0x5da63a));}}function a83_0x1f11(){const _0x4a7c0b=['Shutdown-Queue','error','length','LcZPF','HookRunFinished','includes','CBTSessionCreated','max','status','screenshotEventUrl','utf8','Remaining\x20Queue\x20Length\x20-\x20','splice','BATCH_EVENT_TYPES','\x20event\x20successful\x20for\x20events\x20','message','map','removeEventBatchPolling','shutdown','api/v1/screenshots','TestRunStarted','byteLength','ehLfJ','RESETTING','proceedWithData','aLcaD','util','GuysA','Processing\x20events.\x20Queue\x20Length\x20-\x20','logs','nZWMD','queue','started','EXCEPTION\x20IN\x20','resetEventBatchPolling','shouldProceed','TEST_SCREENSHOT','format','batchAndPostEvents','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','event_type','api/v1/batch','2913348rLjxyp','\x20bytes.\x20Events\x20are\x20','2240883FHKnfs','7977lzmZsr','uuid','response','10OCnmWh','ARIZM','5|4|3|2|0|1','GzUIm','uploadPending','432537TWgLLG','slice','oFZjX','pollEventBatchInterval','1428HNEbWL','\x20REQUEST\x20TO\x20TEST\x20OBSERVABILITY\x20:\x20','startEventBatchPolling','HookRunStarted','./utils','vuTVe','5037465hmpPnj','RuZNF','kind','TestRunFinished','REMOVING','Zdihh','LueiB','483eWurQl','BlPKc','tRFej','Kbrqk','instance','AdWCr','58224ShpnaK','NmBGy','rtgtC','yxDuJ','aZbgW','split','proceedWithUrl','vyave','3178098AMMuxC','stringify','QnDXv','hhasg','VnzBw','zeOxU','rYmdN','Lekjw','POST','KyKrg','TestRunSkipped','add','.\x20Request\x20Size\x20-\x20','BnvgT','4wLmzGi','eventUrl','55MWBTwy','data','push','getInstance','qRHEu','exports','pendingUploads'];a83_0x1f11=function(){return _0x4a7c0b;};return a83_0x1f11();}module[a83_0x545d48(0x16d)]=RequestQueueHandler;