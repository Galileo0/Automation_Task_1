#!/usr/bin/env node
'use strict';const a14_0x22ea7b=a14_0x466a;(function(_0x2c1ecd,_0x1a1409){const _0x132001=a14_0x466a,_0x4ab546=_0x2c1ecd();while(!![]){try{const _0x1f2d23=parseInt(_0x132001(0xb7))/0x1*(parseInt(_0x132001(0xd2))/0x2)+-parseInt(_0x132001(0xa1))/0x3*(-parseInt(_0x132001(0xb9))/0x4)+parseInt(_0x132001(0xaf))/0x5*(parseInt(_0x132001(0xc5))/0x6)+parseInt(_0x132001(0x11e))/0x7+-parseInt(_0x132001(0xf4))/0x8+parseInt(_0x132001(0x110))/0x9+-parseInt(_0x132001(0xda))/0xa*(parseInt(_0x132001(0x11c))/0xb);if(_0x1f2d23===_0x1a1409)break;else _0x4ab546['push'](_0x4ab546['shift']());}catch(_0x273d61){_0x4ab546['push'](_0x4ab546['shift']());}}}(a14_0x17ed,0x44706));function a14_0x466a(_0x14ff50,_0x2f9004){const _0x17edb7=a14_0x17ed();return a14_0x466a=function(_0x466aa8,_0x5ba9e0){_0x466aa8=_0x466aa8-0x85;let _0x153865=_0x17edb7[_0x466aa8];return _0x153865;},a14_0x466a(_0x14ff50,_0x2f9004);}function a14_0x17ed(){const _0x4eb36f=['readFileSync','testRunner','xpszU','../utils/constants','shutdown','Showing\x20jest\x20logs\x20and\x20reporter\x20logs.','2506480ZMydYu','accessibilityOptions','const\x20config=','config','requireModule','launchBuild','true','HEzjh','browserStackPercyOptions','RyhOZ','rmdirSync','Getting\x20your\x20jest\x20configs\x20from\x20','DmSyH','length','MODULE','errorMessage','./test-observability/helper','jest_browserstack_results.json','OxuTy','PZciN','/customImplements/customCircus.js','child\x20process\x20exited\x20with\x20code\x20','cjs','../../helpers/utilities','push','../../helpers/test-observability/utils','platforms','existsSync','1453653xyfftf','mjs','exports','BSTACK_JEST_TEST_ENV','parallels__','isUndefined','../../helpers/accessibility-automation/helper','requireSeleniumWebdriver','VPgjN','\x0amodule.exports\x20=\x20config;','testContextOptions','uBRkG','4909718mEONsM','\x0a\x20\x20\x20\x20','2150232XqlTbR','runner','dPnwA','checkAccessibilityPlatformConfig','testEnvironment','Creating\x20','close','error\x20removing\x20tcg\x20config\x20file','ecvou','parallelsPerPlatform','setupFiles','ojgAO','package.json','stringify','testTimeout','../../helpers/testhub/testhubHandler','--config','setup','fSlqr',';\x0a\x20\x20\x20\x20\x20\x20fs.writeFileSync(path.join(__dirname,\x20\x27jest_browserstack_results.json\x27),\x20JSON.stringify(results));\x0a\x20\x20\x20\x20\x20\x20return\x20_someFunc.call(this,\x20testContexts,\x20results);\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20var\x20_onTestFileResultOrig\x20=\x20ReporterDispatcher.prototype.onTestFileResult;\x0a\x20\x20\x20\x20ReporterDispatcher.prototype.onTestFileResult\x20=\x20async\x20function\x20(test,\x20testResult,\x20result)\x20{\x0a\x20\x20\x20\x20\x20\x20testResult.platform\x20=\x20helper.getPlatformName(test.context.config.capability);\x0a\x20\x20\x20\x20\x20\x20return\x20_onTestFileResultOrig.call(this,\x20test,\x20testResult,\x20result);\x0a\x20\x20\x20\x20}\x0a\x20\x20','aOnFq','getPackageType','findIndex','isBrowserstackInfra','jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js','MCWvC','writeFileSync','debug','Error\x20while\x20parsing\x20','shouldProcessEventForTesthub','jest-circus','\x20with\x20browserstack\x20jest\x20configs','skipSessionName','YkxTj','skipSessionStatus','369ZFTzsg','LNKSV','child_process','win32','getTCGConfigFilePaths','../../helpers/BrowserStackSetup','iqXNq','env','WCbre','parse','cwd','exitCode','rgRCm','Deleting\x20','203935ucHubQ','YBqyu','/customImplements/customTestRunnerTemplate.js','nyZCN','/test_before.setup.js','hFQNi','capabilities','/test-observability/data-hooks.js','63671IhzyFc','log','4408vVjxal','Modifying\x20jest\x20configs\x20to\x20run\x20tests\x20on\x20BrowserStack','util','../../helpers/test-observability/constants','browserStackLogLevel','getErrorMessageFromResults','reporters','maxWorkers','Getting\x20your\x20jest\x20configs\x20from\x20package.json','/jest.setup.js','Lzura','info','36gJoOBZ','splice','../../helpers/testhub/utils','UdkQx','Exception\x20in\x20stop\x20build\x20request\x20to\x20TestHub\x20:\x20','../../helpers/logger','PSTQB','proxySettings','logLevel','\x20:\x20','FRAMEWORKS','join','testEnvironmentOptions','6BYvdON','./test-observability/test-details','markSDKSetupComplete','ezNxC','rupce','unlinkSync','jest','customImplements','10IOzwnw','testObservability','path','platform','Wdsed','resolve','otTid','setupFilesAfterEnv','../../helpers/helper','BROWSERSTACK_TEST_ACCESSIBILITY_YML','inherit','useW3C','assign','JJRHm','setupTCGAuth','stop','EoqMe','BnKoT','jest_browserstack.config.cjs','BROWSERSTACK_TEST_ACCESSIBILITY_CONFIGURATION_YML'];a14_0x17ed=function(){return _0x4eb36f;};return a14_0x17ed();}const fs=require('fs'),path=require(a14_0x22ea7b(0xdc)),util=require(a14_0x22ea7b(0xbb)),{spawn}=require(a14_0x22ea7b(0xa3)),logger=require(a14_0x22ea7b(0xca))['winstonLogger'],{default:BrowserStackSetup}=require(a14_0x22ea7b(0xa6)),helper=require(a14_0x22ea7b(0xe2)),utilities=require(a14_0x22ea7b(0x10b)),constants=require(a14_0x22ea7b(0xf1)),accessibilityHelper=require(a14_0x22ea7b(0x116)),{updateTestRerunConfig}=require(a14_0x22ea7b(0x104)),testOpsHelper=require(a14_0x22ea7b(0x10d)),{debug}=require('../../helpers/test-observability/utils'),TestDetails=require(a14_0x22ea7b(0xd3)),{getPercyOptions}=require('../../helpers/percy/utils'),TestHubHandler=require(a14_0x22ea7b(0x8d)),testhubUtils=require(a14_0x22ea7b(0xc7)),{FRAMEWORKS}=require(a14_0x22ea7b(0xbc)),getUserJestConfigs=(_0x58277e,_0x224421)=>{const _0x17ae83=a14_0x22ea7b,_0x284cb4={'rgRCm':function(_0x29a5ce,_0x5a7acd){return _0x29a5ce(_0x5a7acd);},'ojgAO':function(_0x1695c2,_0x546ccb){return _0x1695c2||_0x546ccb;},'YkxTj':function(_0x2b7b1a,_0x288e1f){return _0x2b7b1a(_0x288e1f);},'BnKoT':_0x17ae83(0x8a),'eGJWi':_0x17ae83(0xc1),'nyZCN':_0x17ae83(0x111),'VPgjN':_0x17ae83(0x10a),'BYVjm':'json'},_0x1c459a=_0x224421[_0x17ae83(0x94)](_0x8e464=>_0x8e464===_0x17ae83(0x8e));if(!helper[_0x17ae83(0x115)](_0x58277e[_0x17ae83(0xf7)])){logger['info'](_0x17ae83(0xff)+_0x58277e['config']);const _0x2d1690=_0x284cb4[_0x17ae83(0xad)](require,path[_0x17ae83(0xdf)](_0x58277e['config']));return _0x224421[_0x17ae83(0xc6)](_0x1c459a,0x2),_0x284cb4[_0x17ae83(0x89)](_0x2d1690,{});}const _0x15b931=_0x284cb4[_0x17ae83(0x9f)](require,path[_0x17ae83(0xd0)](process['cwd'](),_0x284cb4[_0x17ae83(0xeb)]));if(_0x15b931[_0x17ae83(0xd8)])return logger['info'](_0x284cb4['eGJWi']),_0x15b931['jest'];const _0x31136f=['js',_0x284cb4[_0x17ae83(0xb2)],_0x284cb4[_0x17ae83(0x118)],_0x284cb4['BYVjm'],'ts'];for(const _0x2cbf87 of _0x31136f){const _0x2a0a37=path[_0x17ae83(0xd0)](process[_0x17ae83(0xab)](),'jest.config.'+_0x2cbf87);if(fs[_0x17ae83(0x10f)](_0x2a0a37))return _0x284cb4[_0x17ae83(0xad)](require,_0x2a0a37);}return{};},getSerial=(_0x88966,_0x388a83)=>{const _0x2c60c4=a14_0x22ea7b,_0x1fb744={};_0x1fb744[_0x2c60c4(0xa2)]=_0x2c60c4(0xfa),_0x1fb744[_0x2c60c4(0xd5)]=function(_0x344458,_0x438e9d){return _0x344458>_0x438e9d;},_0x1fb744[_0x2c60c4(0x107)]=function(_0x39262f,_0x5c98aa){return _0x39262f>_0x5c98aa;},_0x1fb744['YBqyu']='false';const _0x1c2acc=_0x1fb744;let _0x5f55fd=_0x1c2acc[_0x2c60c4(0xa2)];return _0x1c2acc[_0x2c60c4(0xd5)](_0x88966[_0x2c60c4(0x101)],0x1)&&(!_0x388a83['runInBand']&&(helper[_0x2c60c4(0x115)](_0x388a83['maxWorkers'])||_0x1c2acc[_0x2c60c4(0x107)](_0x388a83['maxWorkers'],0x1)))&&(_0x5f55fd=_0x1c2acc[_0x2c60c4(0xb0)]),_0x5f55fd;},getMaxWorkers=(_0x911581,_0x52e5aa,_0x15eb6d)=>{const _0x35b7b0=a14_0x22ea7b,_0x5d48ce={'RyhOZ':function(_0x3eba3a,_0x108564){return _0x3eba3a(_0x108564);}};let _0x5d40e1=0x1;if(!helper[_0x35b7b0(0x115)](_0x52e5aa[_0x35b7b0(0x87)]))_0x5d40e1=_0x5d48ce[_0x35b7b0(0xfd)](parseInt,_0x52e5aa[_0x35b7b0(0x87)]);else{if(!helper['isUndefined'](_0x911581[_0x35b7b0(0xc0)]))_0x5d40e1=_0x911581[_0x35b7b0(0xc0)];else!helper['isUndefined'](_0x15eb6d['maxWorkers'])&&(_0x5d40e1=_0x15eb6d[_0x35b7b0(0xc0)]);}return _0x5d40e1;};async function run(_0x654b3c,_0x26c6c){const _0x2df556=a14_0x22ea7b,_0x228f70={'uBRkG':_0x2df556(0x85),'HEzjh':_0x2df556(0xd8),'hFQNi':function(_0x2b0059,_0x396fa1){return _0x2b0059(_0x396fa1);},'JJRHm':function(_0x25d3d3,_0x45aee9){return _0x25d3d3!=_0x45aee9;},'znjUQ':_0x2df556(0xfa),'IfzkV':function(_0x17b19b,_0xf979fb,_0x3a8ecc){return _0x17b19b(_0xf979fb,_0x3a8ecc);},'Wdsed':_0x2df556(0xba),'IQMVQ':function(_0x3c2576,_0x130272){return _0x3c2576(_0x130272);},'EoqMe':function(_0x2c3462,_0x2aa366,_0x4acb8d){return _0x2c3462(_0x2aa366,_0x4acb8d);},'Lzura':function(_0x3ada44,_0x2780a1,_0x51ef76,_0x1e5a6b){return _0x3ada44(_0x2780a1,_0x51ef76,_0x1e5a6b);},'DqTjG':function(_0x260d72,_0x1c24cb){return _0x260d72*_0x1c24cb;},'dPnwA':function(_0xd24fa7,_0x3e18ab){return _0xd24fa7===_0x3e18ab;},'rupce':_0x2df556(0xec),'iqXNq':'jest_browserstack.config.js','DmSyH':_0x2df556(0xd9),'fSlqr':_0x2df556(0x105),'gJUyA':_0x2df556(0x96),'npeoT':_0x2df556(0x9c),'aOnFq':function(_0x8c6bb1,_0x1389ad){return _0x8c6bb1(_0x1389ad);},'ecvou':'skipping\x20test_before\x20setup\x20since\x20selenium\x20not\x20found','OxuTy':'default','UdkQx':_0x2df556(0xf3),'WCbre':'npx','MCWvC':_0x2df556(0x8e),'otTid':function(_0x340981,_0x443082){return _0x340981===_0x443082;},'PSTQB':_0x2df556(0xa4),'xpszU':_0x2df556(0xe4),'bzLec':_0x2df556(0x124)},_0x4cc06f=new BrowserStackSetup(_0x654b3c,_0x228f70[_0x2df556(0xfb)]);helper[_0x2df556(0x95)]()?(await _0x4cc06f['initialize'](),await helper['handleApp'](_0x4cc06f[_0x2df556(0xf7)])):await _0x4cc06f[_0x2df556(0xe8)]();if(!_0x4cc06f['config'])return;_0x228f70[_0x2df556(0xe7)](_0x4cc06f[_0x2df556(0xf7)][_0x2df556(0xdb)],null)?process[_0x2df556(0xa8)]['BROWSERSTACK_TEST_OBSERVABILITY_YML']=_0x4cc06f['config'][_0x2df556(0xdb)]:process[_0x2df556(0xa8)]['BROWSERSTACK_TEST_OBSERVABILITY_YML']=_0x228f70['znjUQ'];const _0x4bf72e=_0x228f70['IfzkV'](getUserJestConfigs,_0x654b3c,_0x26c6c);logger[_0x2df556(0xc4)](_0x228f70[_0x2df556(0xde)]);const _0x4f99e3=Object['assign']({},_0x4bf72e);_0x4f99e3[_0x2df556(0xd1)]=Object[_0x2df556(0xe6)]({},_0x4f99e3['testEnvironmentOptions'],{'server':helper['getHubUrl'](_0x4cc06f[_0x2df556(0xf7)]),'environment':_0x4bf72e['testEnvironment']}),_0x4f99e3[_0x2df556(0xd1)][_0x2df556(0xfc)]=_0x228f70['IQMVQ'](getPercyOptions,_0x4cc06f[_0x2df556(0xf7)]);const _0xa173f9=helper[_0x2df556(0xe5)](_0x4cc06f[_0x2df556(0xf7)]),_0x7f8c54=helper['prepareCapabilities'](_0x4cc06f[_0x2df556(0xf7)],_0xa173f9,constants[_0x2df556(0xcf)]['JEST']);!helper[_0x2df556(0x115)](_0x4cc06f[_0x2df556(0xf7)]['accessibilityOptions'])&&(process[_0x2df556(0xa8)][_0x2df556(0xed)]=JSON['stringify'](_0x4cc06f[_0x2df556(0xf7)][_0x2df556(0xf5)]));let _0x20c9f5=_0x4cc06f['config']['accessibility'];_0x20c9f5=_0x20c9f5||accessibilityHelper[_0x2df556(0x121)](_0x4cc06f['config']),process[_0x2df556(0xa8)][_0x2df556(0xe3)]=_0x20c9f5,_0x4f99e3[_0x2df556(0xd1)][_0x2df556(0xb5)]=_0x7f8c54,_0x4f99e3[_0x2df556(0xd1)]['serial__']=_0x228f70['EoqMe'](getSerial,_0x7f8c54,_0x654b3c),_0x4f99e3[_0x2df556(0xd1)][_0x2df556(0x114)]=_0x228f70[_0x2df556(0xc3)](getMaxWorkers,_0x654b3c,_0x4cc06f[_0x2df556(0xf7)],_0x4bf72e),_0x4f99e3[_0x2df556(0xd1)][_0x2df556(0xcc)]=_0x4cc06f['config']['proxySettings'],_0x4f99e3[_0x2df556(0xd1)]['timeout__']=_0x228f70['DqTjG'](_0x654b3c[_0x2df556(0x8c)],0x1)||0x1388,_0x4f99e3[_0x2df556(0xd1)][_0x2df556(0x9e)]=_0x4cc06f[_0x2df556(0xf7)][_0x2df556(0x11a)]['skipSessionName'],_0x4f99e3[_0x2df556(0xd1)]['skipSessionStatus']=_0x4cc06f[_0x2df556(0xf7)][_0x2df556(0x11a)][_0x2df556(0xa0)],_0x4f99e3[_0x2df556(0xd1)][_0x2df556(0xbd)]=_0x4cc06f[_0x2df556(0xf7)][_0x2df556(0xcd)],_0x4f99e3['testEnvironmentOptions']['turboScaleUrl']=_0x4cc06f[_0x2df556(0xf7)]['turboScaleUrl'],_0x4f99e3['testEnvironmentOptions']['platformCaps']=_0x4cc06f['config']['platforms'];let _0x5e4d2c='';_0x228f70[_0x2df556(0x120)](helper[_0x2df556(0x93)](),constants['PACKAGE_TYPE'][_0x2df556(0x102)])?_0x5e4d2c=_0x228f70[_0x2df556(0xd6)]:_0x5e4d2c=_0x228f70[_0x2df556(0xa7)];const _0x4fe152=_0x5e4d2c,_0x215837=path[_0x2df556(0xd0)](__dirname,_0x228f70[_0x2df556(0x100)],_0x228f70[_0x2df556(0x90)]),_0x1be8b4=__dirname+'/customImplements/customTestRunner.js',_0x103c9f=__dirname+_0x2df556(0xb1);_0x4f99e3[_0x2df556(0x122)]&&(process[_0x2df556(0xa8)][_0x2df556(0x113)]=_0x4f99e3[_0x2df556(0x122)]);_0x4f99e3[_0x2df556(0x122)]=__dirname+'/customImplements/customEnvironment.js',_0x4f99e3[_0x2df556(0x11f)]=_0x1be8b4,_0x4f99e3[_0x2df556(0xe1)]=_0x4f99e3[_0x2df556(0xe1)]||[],_0x4f99e3[_0x2df556(0xe1)][_0x2df556(0x10c)](__dirname+_0x2df556(0xc2));if(testhubUtils['shouldProcessEventForTesthub']()){let _0x180d11=null;try{_0x180d11=helper[_0x2df556(0xf8)](_0x228f70['gJUyA'],_0x228f70['npeoT']);}catch(_0x14694b){_0x228f70[_0x2df556(0x92)](debug,'Unable\x20to\x20find\x20jest-circus,\x20'+_0x14694b);}_0x180d11&&(_0x4f99e3[_0x2df556(0xe1)]['push'](__dirname+_0x2df556(0xb6)),_0x4f99e3[_0x2df556(0xef)]=__dirname+_0x2df556(0x108));}_0x4f99e3['setupFiles']=_0x4f99e3[_0x2df556(0x88)]||[];try{helper[_0x2df556(0x117)](),_0x4f99e3[_0x2df556(0x88)][_0x2df556(0x10c)](__dirname+_0x2df556(0xb3));}catch{logger['debug'](_0x228f70[_0x2df556(0x86)]);}_0x4f99e3[_0x2df556(0xbf)]=_0x4f99e3[_0x2df556(0xbf)]||[_0x228f70[_0x2df556(0x106)]],_0x228f70[_0x2df556(0xea)](updateTestRerunConfig,_0x4f99e3,_0x4cc06f);const _0x4c4157=fs[_0x2df556(0xee)](_0x103c9f);fs[_0x2df556(0x98)](_0x4f99e3[_0x2df556(0x11f)],_0x2df556(0x11d)+_0x4c4157+'\x0a\x0a\x20\x20\x20\x20const\x20ReporterDispatcher\x20=\x20_interopRequireDefault(requireModule(\x27@jest/core/build/ReporterDispatcher.js\x27,\x20\x27@jest/core\x27)).default;\x20//node_modules/@jest/core/build/ReporterDispatcher.js\x0a\x20\x20\x20\x20const\x20fs\x20=\x20require(\x27fs\x27);\x0a\x20\x20\x20\x20const\x20path\x20=\x20require(\x27path\x27);\x0a\x20\x20\x20\x20const\x20helper\x20=\x20require(\x27../../../helpers/helper\x27);\x0a\x20\x20\x20\x20var\x20_someFunc\x20=\x20ReporterDispatcher.prototype.onRunComplete;\x0a\x20\x20\x20\x20ReporterDispatcher.prototype.onRunComplete\x20=\x20async\x20function\x20(testContexts,\x20results)\x20{\x0a\x20\x20\x20\x20\x20\x20results.numTotalTestSuites\x20=\x20results.numTotalTestSuites\x20*\x20'+_0x4cc06f['config'][_0x2df556(0x10e)][_0x2df556(0x101)]+_0x2df556(0x91)),logger[_0x2df556(0xc4)](_0x2df556(0x123)+_0x4fe152+_0x2df556(0x9d)),fs[_0x2df556(0x98)](_0x4fe152,_0x2df556(0xf6)+JSON[_0x2df556(0x8b)](_0x4f99e3)+_0x2df556(0x119)),logger[_0x2df556(0xc4)](_0x228f70[_0x2df556(0xc8)]);const _0x56c099=await TestHubHandler[_0x2df556(0xf9)](FRAMEWORKS['JEST'],_0x4cc06f);testhubUtils[_0x2df556(0x9b)]()&&TestDetails[_0x2df556(0x8f)]();helper['filterBrowserstackArgs']({},_0x26c6c),helper[_0x2df556(0xd4)]();const _0x90359f=_0x228f70['Lzura'](spawn,_0x228f70[_0x2df556(0xa9)],[_0x228f70['HEzjh'],_0x228f70[_0x2df556(0x97)],_0x4fe152,..._0x26c6c['slice'](0x1)],{'shell':_0x228f70[_0x2df556(0xe0)](process[_0x2df556(0xdd)],_0x228f70[_0x2df556(0xcb)]),'stdio':_0x228f70[_0x2df556(0xf0)],'env':Object[_0x2df556(0xe6)]({},process[_0x2df556(0xa8)])});_0x90359f['on'](_0x228f70['bzLec'],async _0x58aa4d=>{const _0x13ace6=_0x2df556;try{const {browserstackFolderPath:_0x5b083c,tcgConfigPath:_0x485ce5}=helper[_0x13ace6(0xa5)]();fs[_0x13ace6(0xd7)](_0x485ce5),fs[_0x13ace6(0xfe)](_0x5b083c);}catch(_0x2e7b69){logger['debug'](_0x228f70[_0x13ace6(0x11b)],_0x2e7b69);}process[_0x13ace6(0xac)]=_0x58aa4d,logger[_0x13ace6(0x99)](_0x13ace6(0x109)+_0x58aa4d),logger[_0x13ace6(0xc4)](_0x13ace6(0xae)+_0x4fe152);let _0x57e736=null;if(fs['existsSync'](_0x215837)){_0x57e736=fs['readFileSync'](_0x215837);try{_0x57e736=JSON[_0x13ace6(0xaa)](_0x57e736);}catch(_0x312502){logger['debug'](_0x13ace6(0x9a)+_0x215837+',\x20'+_0x57e736+_0x13ace6(0xce)+_0x312502);}fs[_0x13ace6(0xd7)](_0x215837);}fs[_0x13ace6(0xd7)](_0x4fe152),fs[_0x13ace6(0xd7)](_0x1be8b4),_0x57e736&&(_0x4cc06f[_0x13ace6(0x103)]=helper[_0x13ace6(0xbe)](_0x57e736,_0x228f70[_0x13ace6(0xfb)],_0x4cc06f));try{await TestHubHandler[_0x13ace6(0xe9)]();}catch(_0x5ee1b2){console[_0x13ace6(0xb8)](_0x5ee1b2),_0x228f70[_0x13ace6(0xb4)](debug,_0x13ace6(0xc9)+util['format'](_0x5ee1b2));}testOpsHelper['printBuildLink'](),TestDetails[_0x13ace6(0xf2)](),await utilities['finalExecution'](_0x4cc06f);});}module[a14_0x22ea7b(0x112)]=run;