const a72_0x13584b=a72_0xe34f;(function(_0x224851,_0x650bd9){const _0x3e2a9b=a72_0xe34f,_0x1feb49=_0x224851();while(!![]){try{const _0x2ae1ce=-parseInt(_0x3e2a9b(0x20a))/0x1*(parseInt(_0x3e2a9b(0x208))/0x2)+-parseInt(_0x3e2a9b(0x1fa))/0x3*(-parseInt(_0x3e2a9b(0x201))/0x4)+parseInt(_0x3e2a9b(0x1cb))/0x5*(-parseInt(_0x3e2a9b(0x1a8))/0x6)+parseInt(_0x3e2a9b(0x1a6))/0x7*(-parseInt(_0x3e2a9b(0x1ce))/0x8)+-parseInt(_0x3e2a9b(0x19f))/0x9*(-parseInt(_0x3e2a9b(0x1b2))/0xa)+parseInt(_0x3e2a9b(0x212))/0xb+parseInt(_0x3e2a9b(0x19a))/0xc*(parseInt(_0x3e2a9b(0x1d1))/0xd);if(_0x2ae1ce===_0x650bd9)break;else _0x1feb49['push'](_0x1feb49['shift']());}catch(_0x1a6421){_0x1feb49['push'](_0x1feb49['shift']());}}}(a72_0x2390,0xe1be1));const {https}=require(a72_0x13584b(0x207)),url=require(a72_0x13584b(0x1d3)),yauzl=require('yauzl'),fs=require('fs'),path=require(a72_0x13584b(0x19b)),os=require('os'),{spawn}=require(a72_0x13584b(0x1ea)),HttpsProxyAgent=require('https-proxy-agent'),logger=require('../logger')[a72_0x13584b(0x1e5)];function a72_0x2390(){const _0x56c585=['LKiSe','platform','child_process','percy','tbhsr','error','BedoB','XGqzo','YcmIx','LOGNAME','XBYDk','Got\x20Error\x20in\x20percy\x20binary\x20download\x20response','QPOUk','env','KyOVQ','undefined','QQhVU','vAkUq','12AoemEx','dIJuM','entry','parse','btOqh','homedir','/Users/','897592NPcQlF','IPFji','dBvsi','JYwIT','validateBinary','open','follow-redirects','177326WSCpwd','JNTFR','9mvzziF','JNKHg','accessSync','proxyPort','.zip','getBinaryPath','bwbJC','Ofdys','19765185PxCiJI','ftwWN','kToLs','xEBee','createWriteStream','readEntry','jtxpQ','ZkWEh','twAwk','RFzlw','.browserstack','cwd','60QuWAyg','path','function','chmod','OpcCa','2836467hvOosj','linux','zTfDm','lclgq','kcnqv','readFileSync','getuid','9568993vqMZDz','oeaxd','517236MuueER','pipe','snbVw','test','apFJE','bhxjJ','end','download','once','/percy-linux.zip','10vddYGh','Fgxqg','--version','YxIcq','Got\x20Error\x20while\x20downloading\x20percy\x20binary\x20file','win32','R_OK','Uffxc','AGjbh','ZbqfL','https://github.com/percy/cli/releases/latest/download','Donxn','vXfAv','TOYjC','match','useCaCertificate','XOcEk','mkdirSync','proxyHost','USER','sBYmq','W_OK','oaNqG','lazyEntries','LnvtA','90HpZljh','Percy\x20download\x20failed\x20to\x20read\x20cert\x20file','get','8uGVQPQ','hVSxB','ocmjv','4242485LUfISy','length','url','/percy-osx.zip','close','percy.exe','Ilbez','join','LdxAw','0755','nzcMg','oxpDh','LNAME','wZUwu','tmpdir','ZLMSO','DRdjo','fileName','iDNjv','DyiWH','winstonLogger','fMhAs','qEcnW'];a72_0x2390=function(){return _0x56c585;};return a72_0x2390();}function a72_0xe34f(_0xa96432,_0x53b404){const _0x2390ae=a72_0x2390();return a72_0xe34f=function(_0xe34fd4,_0x1a977a){_0xe34fd4=_0xe34fd4-0x194;let _0xf41d48=_0x2390ae[_0xe34fd4];return _0xf41d48;},a72_0xe34f(_0xa96432,_0x53b404);}class PercyBinary{#hostOS=process[a72_0x13584b(0x1e9)];#httpPath=null;#binaryName=a72_0x13584b(0x1eb);#orderedPaths=[path[a72_0x13584b(0x1d8)](this.#homedir(),a72_0x13584b(0x198)),process[a72_0x13584b(0x199)](),os[a72_0x13584b(0x1df)]()];constructor(){const _0x180b1f=a72_0x13584b,_0x1e54b7={};_0x1e54b7[_0x180b1f(0x196)]=_0x180b1f(0x1bc),_0x1e54b7['oaNqG']=function(_0x262608,_0x91f321){return _0x262608+_0x91f321;},_0x1e54b7['ZbqfL']=_0x180b1f(0x1d4),_0x1e54b7[_0x180b1f(0x195)]=function(_0x33a6c0,_0x421c8f){return _0x33a6c0+_0x421c8f;},_0x1e54b7['vBLrV']='/percy-win.zip',_0x1e54b7[_0x180b1f(0x1bd)]=_0x180b1f(0x1d6),_0x1e54b7['zTfDm']=function(_0x5ca3b0,_0x12ae45){return _0x5ca3b0+_0x12ae45;},_0x1e54b7[_0x180b1f(0x1cf)]=_0x180b1f(0x1b1);const _0x3726e1=_0x1e54b7,_0x453d29=_0x3726e1[_0x180b1f(0x196)];if(this.#hostOS[_0x180b1f(0x1c0)](/darwin|mac os/i))this.#httpPath=_0x3726e1[_0x180b1f(0x1c8)](_0x453d29,_0x3726e1[_0x180b1f(0x1bb)]);else this.#hostOS[_0x180b1f(0x1c0)](/mswin|msys|mingw|cygwin|bccwin|wince|emc|win32/i)?(this.#httpPath=_0x3726e1[_0x180b1f(0x195)](_0x453d29,_0x3726e1['vBLrV']),this.#binaryName=_0x3726e1[_0x180b1f(0x1bd)]):this.#httpPath=_0x3726e1[_0x180b1f(0x1a1)](_0x453d29,_0x3726e1[_0x180b1f(0x1cf)]);}#getAvailableDirs(){const _0x242cbc=a72_0x13584b,_0x1ee44f={};_0x1ee44f[_0x242cbc(0x1e1)]=function(_0x1d24a9,_0x6aeb66){return _0x1d24a9<_0x6aeb66;},_0x1ee44f[_0x242cbc(0x1e6)]='Error\x20trying\x20to\x20download\x20percy\x20binary';const _0x1ca70a=_0x1ee44f;for(var _0x18cc79=0x0;_0x1ca70a[_0x242cbc(0x1e1)](_0x18cc79,this.#orderedPaths[_0x242cbc(0x1d2)]);_0x18cc79++){var _0x2caba3=this.#orderedPaths[_0x18cc79];if(this.#makePath(_0x2caba3))return _0x2caba3;}throw new Error(_0x1ca70a[_0x242cbc(0x1e6)]);}#makePath(_0xedddeb){try{return!this.#checkPath(_0xedddeb)&&fs['mkdirSync'](_0xedddeb),!![];}catch{return![];}}#checkPath(_0x57597d,_0x5b7a37){const _0x3a4b5a=a72_0x13584b,_0x478c0a={};_0x478c0a[_0x3a4b5a(0x19e)]=function(_0x2fca49,_0x12cd76){return _0x2fca49|_0x12cd76;},_0x478c0a[_0x3a4b5a(0x20b)]=function(_0x5c45aa,_0x235040){return _0x5c45aa!==_0x235040;},_0x478c0a['ftwWN']=_0x3a4b5a(0x1f7);const _0x485073=_0x478c0a;_0x5b7a37=_0x5b7a37||_0x485073[_0x3a4b5a(0x19e)](fs[_0x3a4b5a(0x1b8)],fs[_0x3a4b5a(0x1c7)]);try{return fs[_0x3a4b5a(0x20c)](_0x57597d,_0x5b7a37),!![];}catch(_0x207871){if(_0x485073[_0x3a4b5a(0x20b)](typeof fs[_0x3a4b5a(0x20c)],_0x485073[_0x3a4b5a(0x213)]))return![];try{return fs['statSync'](_0x57597d),!![];}catch(_0x1c8d00){return![];}}}async[a72_0x13584b(0x20f)](_0x44385e){const _0x1fdb5c=a72_0x13584b,_0x4fa8a7={};_0x4fa8a7[_0x1fdb5c(0x1dc)]='Corrupt\x20percy\x20binary,\x20retrying';const _0x401375=_0x4fa8a7;var _0x3d8f92=this.#getAvailableDirs(),_0x7f8549=path[_0x1fdb5c(0x1d8)](_0x3d8f92,this.#binaryName);if(this.#checkPath(_0x7f8549,fs['X_OK']))return _0x7f8549;const _0xc8efcc=await this['download'](_0x44385e,_0x3d8f92),_0x53028d=await this[_0x1fdb5c(0x205)](_0xc8efcc);if(!_0x53028d)return logger[_0x1fdb5c(0x1ed)](_0x401375[_0x1fdb5c(0x1dc)]),await this[_0x1fdb5c(0x1af)](_0x44385e,_0x3d8f92);return _0xc8efcc;}async[a72_0x13584b(0x205)](_0x2b89b1){const _0x1a47bd=a72_0x13584b,_0x110ee1={'LKiSe':function(_0x42ddbe,_0x2aa75f){return _0x42ddbe(_0x2aa75f);},'YxIcq':function(_0x7c0da8,_0x3c3f31,_0x25b864){return _0x7c0da8(_0x3c3f31,_0x25b864);},'QKzDs':_0x1a47bd(0x1b4),'lclgq':'data','UENsP':_0x1a47bd(0x1d5)},_0x43c45c=/^.*@percy\/cli \d.\d+.\d+/;return new Promise((_0x534459,_0x47634c)=>{const _0x359005=_0x1a47bd,_0x43c04a={'wZUwu':function(_0x421950,_0xb8949d){const _0x1b17c2=a72_0xe34f;return _0x110ee1[_0x1b17c2(0x1e8)](_0x421950,_0xb8949d);}},_0x220334=_0x110ee1[_0x359005(0x1b5)](spawn,_0x2b89b1,[_0x110ee1['QKzDs']]);_0x220334['stdout']['on'](_0x110ee1[_0x359005(0x1a2)],_0x199804=>{const _0x8911c=_0x359005;_0x43c45c[_0x8911c(0x1ab)](_0x199804)&&_0x110ee1[_0x8911c(0x1e8)](_0x534459,!![]);}),_0x220334['on'](_0x110ee1['UENsP'],()=>{const _0x568187=_0x359005;_0x43c04a[_0x568187(0x1de)](_0x534459,![]);});});}[a72_0x13584b(0x1af)](_0x4e6745,_0x2ee388){const _0x4382ca=a72_0x13584b,_0x58aa31={'vXfAv':_0x4382ca(0x1f3),'usidR':function(_0x33e5e8,_0x32763d){return _0x33e5e8(_0x32763d);},'ASopa':_0x4382ca(0x1b6),'RFzlw':_0x4382ca(0x1ed),'Fgxqg':'close','ZLMSO':function(_0x2cfa4a,_0xb1327d){return _0x2cfa4a(_0xb1327d);},'XOcEk':_0x4382ca(0x1ae),'vAkUq':function(_0x2cd7c4,_0x919476){return _0x2cd7c4===_0x919476;},'QQhVU':_0x4382ca(0x1da),'VxHlQ':_0x4382ca(0x1fc),'oeaxd':'Got\x20Error\x20in\x20percy\x20binary\x20downloading\x20request','CVLWY':function(_0x1acc4c,_0xcb1872){return _0x1acc4c+_0xcb1872;},'Ofdys':_0x4382ca(0x20e),'apFJE':_0x4382ca(0x1cc)};!this.#checkPath(_0x2ee388)&&fs[_0x4382ca(0x1c3)](_0x2ee388);const _0x3e9e6f=this.#binaryName,_0x67bb37=path['join'](_0x2ee388,_0x58aa31['CVLWY'](_0x3e9e6f,_0x58aa31[_0x4382ca(0x211)])),_0x5f5529=path['join'](_0x2ee388,_0x3e9e6f),_0x142769=fs[_0x4382ca(0x216)](_0x67bb37),_0x322eee=url[_0x4382ca(0x1fd)](this.#httpPath);if(_0x4e6745[_0x4382ca(0x1c4)]&&_0x4e6745[_0x4382ca(0x20d)]){const _0xde92c4={};_0xde92c4['host']=_0x4e6745[_0x4382ca(0x1c4)],_0xde92c4['port']=_0x4e6745['proxyPort'],_0x322eee['agent']=new HttpsProxyAgent(_0xde92c4);}if(_0x4e6745[_0x4382ca(0x1c1)])try{_0x322eee['ca']=fs[_0x4382ca(0x1a4)](_0x4e6745[_0x4382ca(0x1c1)]);}catch(_0x1f8a20){logger[_0x4382ca(0x1ed)](_0x58aa31[_0x4382ca(0x1ac)],_0x1f8a20);}return new Promise((_0x22d819,_0x50403a)=>{const _0x1e6280=_0x4382ca,_0x33c00e={'TOYjC':function(_0x27bccb,_0x2e3be8){return _0x58aa31['ZLMSO'](_0x27bccb,_0x2e3be8);},'JNTFR':_0x58aa31[_0x1e6280(0x1c2)],'NPtKE':function(_0x96f9aa,_0x2bfb23){const _0xd9c2f7=_0x1e6280;return _0x58aa31[_0xd9c2f7(0x1f9)](_0x96f9aa,_0x2bfb23);},'AZfnm':_0x58aa31[_0x1e6280(0x1f8)],'BedoB':_0x58aa31['VxHlQ'],'IPFji':_0x58aa31[_0x1e6280(0x197)],'IToju':_0x58aa31[_0x1e6280(0x1a7)],'XBYDk':function(_0x268edd,_0x5de4b2){const _0x1863c5=_0x1e6280;return _0x58aa31[_0x1863c5(0x1e0)](_0x268edd,_0x5de4b2);}};https[_0x1e6280(0x1cd)](_0x322eee,function(_0x253ac8){const _0x5afd1b=_0x1e6280,_0x5f38f4={'btOqh':_0x58aa31[_0x5afd1b(0x1be)],'bwbJC':function(_0x4e4a01,_0x444292){return _0x58aa31['usidR'](_0x4e4a01,_0x444292);},'kJVhI':_0x58aa31['ASopa']};_0x253ac8[_0x5afd1b(0x1a9)](_0x142769),_0x253ac8['on'](_0x58aa31[_0x5afd1b(0x197)],function(_0x2b2021){const _0x5817f4=_0x5afd1b;logger[_0x5817f4(0x1ed)](_0x5f38f4[_0x5817f4(0x1fe)],_0x2b2021),_0x5f38f4[_0x5817f4(0x210)](_0x50403a,_0x2b2021);}),_0x142769['on'](_0x58aa31[_0x5afd1b(0x197)],function(_0x5a50c4){const _0x1bf5a0=_0x5afd1b;logger[_0x1bf5a0(0x1ed)](_0x5f38f4['kJVhI'],_0x5a50c4),_0x5f38f4[_0x1bf5a0(0x210)](_0x50403a,_0x5a50c4);}),_0x142769['on'](_0x58aa31[_0x5afd1b(0x1b3)],function(){const _0x5deed7=_0x5afd1b,_0x184e00={'qEcnW':function(_0x5b4d6d,_0x517f9e){return _0x33c00e['TOYjC'](_0x5b4d6d,_0x517f9e);},'snbVw':_0x33c00e[_0x5deed7(0x209)],'AGjbh':function(_0x5c7bb3,_0x409140){return _0x33c00e['NPtKE'](_0x5c7bb3,_0x409140);},'Uffxc':_0x33c00e['AZfnm'],'kToLs':function(_0xdda791,_0x751f77){const _0x590cda=_0x5deed7;return _0x33c00e[_0x590cda(0x1bf)](_0xdda791,_0x751f77);},'tbhsr':_0x33c00e[_0x5deed7(0x1ee)],'bhxjJ':_0x33c00e[_0x5deed7(0x202)]},_0x5b7b97={};_0x5b7b97[_0x5deed7(0x1c9)]=!![],yauzl[_0x5deed7(0x206)](_0x67bb37,_0x5b7b97,function(_0x3840bd,_0x45ce6d){const _0x40d5e6=_0x5deed7,_0x43dcc8={'JYwIT':function(_0x6be98d,_0x16d11c){const _0x2f1c09=a72_0xe34f;return _0x184e00[_0x2f1c09(0x1e7)](_0x6be98d,_0x16d11c);},'QPOUk':_0x184e00[_0x40d5e6(0x1aa)],'dIJuM':function(_0x353d13,_0x332410){const _0x1ec7e6=_0x40d5e6;return _0x184e00[_0x1ec7e6(0x1ba)](_0x353d13,_0x332410);},'nzAPj':function(_0x787395,_0x2dc16b){const _0x3a4976=_0x40d5e6;return _0x184e00[_0x3a4976(0x1e7)](_0x787395,_0x2dc16b);},'xEBee':_0x184e00[_0x40d5e6(0x1b9)]};_0x3840bd&&_0x184e00[_0x40d5e6(0x214)](_0x50403a,_0x3840bd),_0x45ce6d[_0x40d5e6(0x217)](),_0x45ce6d['on'](_0x184e00[_0x40d5e6(0x1ec)],_0x14be13=>{const _0x21f2e1=_0x40d5e6,_0x1cfa50={'sBYmq':function(_0x2f2150,_0x258f03){const _0x3933bf=a72_0xe34f;return _0x43dcc8[_0x3933bf(0x204)](_0x2f2150,_0x258f03);},'optQh':_0x43dcc8[_0x21f2e1(0x1f4)]};if(/\/$/['test'](_0x14be13[_0x21f2e1(0x1e2)]))_0x45ce6d['readEntry']();else{const _0x456f7b=fs['createWriteStream'](path[_0x21f2e1(0x1d8)](_0x2ee388,_0x14be13['fileName']));_0x45ce6d['openReadStream'](_0x14be13,function(_0x5b2d93,_0x5f1809){const _0x537a5c=_0x21f2e1;_0x5b2d93&&_0x1cfa50[_0x537a5c(0x1c6)](_0x50403a,_0x3840bd),_0x5f1809['on'](_0x1cfa50['optQh'],function(){const _0x59b6fd=_0x537a5c;_0x456f7b[_0x59b6fd(0x1d5)](),_0x45ce6d[_0x59b6fd(0x217)]();}),_0x5f1809[_0x537a5c(0x1a9)](_0x456f7b);}),_0x43dcc8[_0x21f2e1(0x1fb)](_0x14be13[_0x21f2e1(0x1e2)],_0x3e9e6f)&&_0x45ce6d[_0x21f2e1(0x1d5)]();}}),_0x45ce6d['on'](_0x184e00[_0x40d5e6(0x1ad)],_0x3667d1=>{const _0x5233cc=_0x40d5e6;_0x43dcc8[_0x5233cc(0x204)](_0x50403a,_0x3667d1);}),_0x45ce6d[_0x40d5e6(0x1b0)](_0x184e00[_0x40d5e6(0x1aa)],()=>{const _0xcc4979=_0x40d5e6;fs[_0xcc4979(0x19d)](_0x5f5529,_0x43dcc8[_0xcc4979(0x215)],function(_0x31912c){const _0x5dccc0=_0xcc4979;_0x31912c&&_0x43dcc8['nzAPj'](_0x50403a,_0x31912c),_0x43dcc8[_0x5dccc0(0x204)](_0x22d819,_0x5f5529);}),_0x45ce6d['close']();});});});})['on'](_0x58aa31[_0x1e6280(0x197)],function(_0x25cd62){const _0x1563d9=_0x1e6280;logger['error'](_0x33c00e['IToju'],_0x25cd62),_0x33c00e[_0x1563d9(0x1f2)](_0x50403a,_0x25cd62);});});}#homedir(){const _0xc1f42=a72_0x13584b,_0xb34f88={};_0xb34f88[_0xc1f42(0x1f6)]=function(_0x5e2805,_0x4986b3){return _0x5e2805===_0x4986b3;},_0xb34f88['dBvsi']=_0xc1f42(0x19c),_0xb34f88['XGqzo']=_0xc1f42(0x1b7),_0xb34f88['PxobL']=function(_0x114290,_0x5be52c){return _0x114290+_0x5be52c;},_0xb34f88['nzcMg']=function(_0x52d711,_0x2fab4f){return _0x52d711===_0x2fab4f;},_0xb34f88[_0xc1f42(0x1d7)]='darwin',_0xb34f88[_0xc1f42(0x1e3)]=function(_0xc92968,_0x55aaff){return _0xc92968+_0x55aaff;},_0xb34f88[_0xc1f42(0x1d9)]=_0xc1f42(0x200),_0xb34f88['YcmIx']=function(_0x1867a8,_0x1b2e1a){return _0x1867a8===_0x1b2e1a;},_0xb34f88['LnvtA']=_0xc1f42(0x1a0),_0xb34f88[_0xc1f42(0x1e4)]='/root',_0xb34f88[_0xc1f42(0x194)]=function(_0x5afdef,_0x4fb32f){return _0x5afdef+_0x4fb32f;},_0xb34f88[_0xc1f42(0x1a3)]='/home/',_0xb34f88[_0xc1f42(0x1d0)]=function(_0x1550c0,_0x49cc26){return _0x1550c0||_0x49cc26;};const _0x48fea8=_0xb34f88;if(_0x48fea8['KyOVQ'](typeof os[_0xc1f42(0x1ff)],_0x48fea8[_0xc1f42(0x203)]))return os[_0xc1f42(0x1ff)]();const _0x665fdb=process[_0xc1f42(0x1f5)],_0x2ebbd3=_0x665fdb['HOME'],_0x15f5f6=_0x665fdb[_0xc1f42(0x1f1)]||_0x665fdb[_0xc1f42(0x1c5)]||_0x665fdb[_0xc1f42(0x1dd)]||_0x665fdb['USERNAME'];if(_0x48fea8[_0xc1f42(0x1f6)](process[_0xc1f42(0x1e9)],_0x48fea8[_0xc1f42(0x1ef)]))return _0x665fdb['USERPROFILE']||_0x48fea8['PxobL'](_0x665fdb['HOMEDRIVE'],_0x665fdb['HOMEPATH'])||_0x2ebbd3||null;if(_0x48fea8[_0xc1f42(0x1db)](process[_0xc1f42(0x1e9)],_0x48fea8['Ilbez']))return _0x2ebbd3||(_0x15f5f6?_0x48fea8[_0xc1f42(0x1e3)](_0x48fea8[_0xc1f42(0x1d9)],_0x15f5f6):null);if(_0x48fea8[_0xc1f42(0x1f0)](process[_0xc1f42(0x1e9)],_0x48fea8[_0xc1f42(0x1ca)]))return _0x2ebbd3||(_0x48fea8['nzcMg'](process[_0xc1f42(0x1a5)](),0x0)?_0x48fea8[_0xc1f42(0x1e4)]:_0x15f5f6?_0x48fea8[_0xc1f42(0x194)](_0x48fea8[_0xc1f42(0x1a3)],_0x15f5f6):null);return _0x48fea8[_0xc1f42(0x1d0)](_0x2ebbd3,null);}}module['exports']=PercyBinary;